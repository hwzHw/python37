<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>购物车</title>
	{% load static %}
	<link rel="stylesheet" href="{% static 'css/style.css' %}">
	<link rel="stylesheet" href="{% static 'css/index.css' %}">
	<link rel="stylesheet" href="{% static 'css/shopcar.css' %}">
	<link rel="stylesheet" href="{% static 'css/product.css' %}">
	<script type="text/javascript" src="{% static 'js/lib/jquery/jquery-1.12.4.min.js' %}"></script>

	<!--<script type="text/javascript" src="../js/index.js"></script>-->
	<script type="text/javascript" src="{% static 'js/lib/jquery/index.js' %}"></script>
	<!--<script type="text/javascript" src="../js/jquery.validate.js"></script>-->
	<script type="text/javascript" src="{% static 'js/lib/jquery/jquery.validate.js' %}"></script>
	<!--<script type="text/javascript" src="../js/messages_zh.js"></script>-->
	<script type="text/javascript" src="{% static 'js/lib/jquery/messages_zh.js' %}"></script>
	<!--<script type="text/javascript" src="../js/jquery.cookie.js" ></script>-->
	<script type="text/javascript" src="{% static 'js/lib/jquery/jquery.cookie.js' %}" ></script>
	<!--<script type="text/javascript" src="../js/shopcart.js" ></script>-->
	<script type="text/javascript" src="{% static 'js/lib/jquery/shopcart.js' %}" ></script>
	<script type="text/javascript" src="{% static 'js/lib/jquery/product.js' %}" ></script>
	<!--<script type="text/javascript" src="../js/shopcar.js"></script>-->
	<script type="text/javascript" src="{% static 'js/lib/jquery/shopcar.js' %}"></script>


</head>
<body>
	<!--吸顶搜索框-->
	<div id="fix-search">
		<div class="fix-search">
			<h1><img src="../img/slogo.png" alt="" width="77" height="40"/></h1>
			<form action="">
				<input type="text" placeholder="连衣裙" class="txt"/>
				<input type="button" value="搜索" class="btn"/>
			</form>
			<span>没空去韩国？就来韩都衣舍!</span>
		</div>
	</div>
	<script type="text/javascript">
		window.onscroll=function(){
		  var t=document.documentElement.scrollTop||document.body.scrollTop;
		  if(t>760){
		    $('#fix-search').slideDown();

		  }else{
		    $('#fix-search').slideUp();

		  }
		 if(t>760){
		    $('#fix-search').fadeIn();

		  }else{
		    $('#fix-search').fadeOut();

		  }
	  }
	</script>
	<!-- global-nav -->
	<div id="global-nav">
		<div class="global-nav">
			<ul class="global-fl">
				<li class="nav-toindex"><a href="{% url 'users:index' %}">返回首页</a></li>
				<li class="nav-collect"><a href="#">收藏网站</a></li>
			</ul>
			<div class="global-fr">
				<ul class="global-login">
					<li>您好，欢迎光临韩都衣舍！</li>
					<!--<li><a href="login_success.html">登录</a></li>-->
					<!--<li><a href="register.html"><span>注册</span></a></li>-->

					{% if request.session.loginUser %}
						<li><a href="#">{{request.session.loginUser}}</a></li>
						<li><a href="/users/del_login"><span>退出</span></a></li>
					{% else %}
						<li><a href="/users/user_login/">登录</a></li>
						<li><a href="{% url 'users:user_register' %}"><span>注册</span></a></li>
					{% endif %}
					<li><a href="#">购物车</a></li>
				</ul>
				<ul class="global-help">
					<li><a href="#">在线客服</a></li>
					<li><a href="#">帮助中心</a></li>
					<li id="site-nav-display"><a  href="#"><span></span>网站导航</a>
						<ul class="site-nav">
							<li class="nav-hot">
								<h2>大家都在买 Hot</h2>
								<a href="">T恤</a>
								<a href="">连衣裙</a>
								<a href="">牛仔裤</a>
								<a href="">毛衣针织</a>
								<a href="">卫衣绒衫</a>
								<a href="">休闲套装</a>
							</li>
							<li class="nav-women">
								<h2>女装  Women</h2>
								<a href="">韩风快时尚女装</a>
								<a href="">韩风快时尚妈妈装</a>
								<a href="">韩风甜美少女装</a>
								<a href="">韩风复古设计师女装</a>
								<a href="">韩风名媛时尚女装</a>
								<a href="">欧美浪漫田园风女装</a>
								<a href="">韩风大码女装</a>
								<a href="">欧美快时尚女装</a>
							</li>
							<li class="nav-men one-line">
								<h2>男装 Men</h2>
								<a href="">韩风快时尚男装</a>
								<a href="">东方禅意设计师男装</a>
								<a href="">欧美街头轻潮男装</a>
							</li>
							<li class="nav-children one-line">
								<h2>童装 Children</h2>
								<a href="">韩风快时尚童装</a>
								<a href="">东方简约设计师童装</a>
							</li>
							<li class="nav-help" style="border:0">
								<h2>帮助中心 Help</h2>
								<a href="">会员制度</a>
								<a href="">售后服务</a>
								<a href="">购物流程</a>
								<a href="">韩都招聘</a>
							</li>
						</ul>
					</li>
				</ul>
			</div>

		</div>

	</div>


	<!-- 购物车内容 -->
	<div class='cart_header'>
	    <a href="" class='cart_logo fl'></a>
	    <div class='cart_step step1 fr'></div>
	</div>
	<div class='wrap'>
		<div class='warm_tip'><span>温馨提示：</span>购物车中商品无法保留库存，请您及时下单结算</div>
		<form id="formCart" name="formCart" method="post" action="{% url 'orders:confirm' %}">
			{% csrf_token %}
	    <div class="shopping_nr">
			<div class="shopping_nr_title">
				<div class="shop_qx" style="width: 40px;"><input type="checkbox" value="1" id="checkall"> </div>
				<div class="shop_qx" style="width: 450px;">商品名称</div>
				<div class="shop_qx" style="width: 117px;">售价</div>
				<div class="shop_qx" style="width: 143px;">数量</div>
				<div class="shop_qx" style="width: 157px;">小计</div>
				<div class="shop_qx" style="width: 162px;">操作</div>
			</div>
			{% for s in shopcarts %}
			<div class="shopping_nr_title1">
				<div class="shop_qx" style="width: 40px;">
				<input type="checkbox" class="g-item" checked value="{{s.id}}" name="s_id"></div>
				<div class="shop_qx" style="width: 452px;">{{s.goods.name}}</div>
				<div class="shop_qx" style="width: 117px;"><span id="price_{{s.goods.id}}">{{s.goods.price}}</span></div>
				<div class="shop_qx" style="width: 143px;">
					 <input type="number" value="{{s.count}}" style="height:23px;text-align:center" name="count" id="count_{{s.goods.id}}">
				</div>
				<div class="shop_qx" style="width: 157px;"><span id="subtotal_{{s.goods.id}}">{{s.allTotal}}</span></div>
				<div class="shop_qx" style="width: 162px;">操作</div>
			</div>

			<!--小计变化-->
			<script>
				$("#count_{{s.goods.id}}").on('change',function(e){
					//获取界面商品数量
					count = e.target.value;
					if (count >= 1){
						//获取界面商品单价
						price = ($("#price_{{s.goods.id}}").text())
						//计算小计
						$("#subtotal_{{s.goods.id}}").text(count*price)
						zjg = ($("#subtotal_{{s.goods.id}}").text())
						//将小计返回到后台
						$.ajax({
							url:"/shopcart/zj/",
							method:"POST",
							data:{"zj":count*price,"sl":count,"s_id":{{s.id}},"zjg":zjg},
							success: function(data) {
								console.info(data)
							},
							error: function(){
								console.info(111111)
							}
						})
					}
					else{
						$(e.target).val(1)
						//alert('请输入正确的购买数量');
					}
				})
			</script>
			{% endfor %}

			<!-- 引入js的位置之一 -->
			<script>
				$(function() {
					// 全选/反选效果
					$("#checkall").on("click", function() {
						// 判断属性是否选中
						if($(this).prop("checked")){
							// 选中的情况下，所有的复选框要求都要选中
							$(".g-item").each(function() {
								$(this).prop("checked", true);
							})
						} else {
							$(".g-item").each(function() {
								$(this).prop("checked", false);
							})
						}
					});


					// 单个商品效果
					$(".g-item").on("click", function() {
						// 声明一个变量，用来判断是否全选状态
						var _flag = true;
						for(var i = 0; i < $(".g-item").size(); i++) {
							var _g = $(".g-item")[i];
							console.log($(_g));
							console.log($(_g).prop("checked"));
							console.log(!($(_g).prop("checked")));
							if(!($(_g).prop("checked"))) {
								// 不是全选
								_flag = false;
							}
						}
						if(_flag) {
							$("#checkall").prop("checked", true);
						} else {
							$("#checkall").prop("checked", false);
						}
					})
				})
			</script>

			<div class="shopcart scBox">
				<table>

					<tbody class="cartItems">
					</tbody>
				</table>
			</div>

			<div class="shopping_car_bottom"></div>

		    <a href="/index/">
		    	<div class="cart_btn btn9 fl" style='margin-right:10px;margin-top:12px;'></div>
		    </a>

			</div>
			<button type="submit">点击结算</button>

		</form>

		<div class="div_deleted">
			<h1 id="show_del_msg"></h1>
			<ul class='deleted'>

			</ul>
		</div>
	</div>

	<!-- footer -->
	<div id="footer">
		<!-- footer-info -->
		<div id="footer-info">
			<div class="footer-info-item">
				<h3 style="background: url(../img/footer01.png) no-repeat -9px 0"></h3>
				<a href="#">用户注册</a>
				<a href="#">购物流程</a>
				<a href="#">网站导航</a>
				<a href="#">帮助中心</a>
			</div>
			<div class="footer-info-item">
				<h3 style="background: url(../img/footer01.png) no-repeat -11px -34px"></h3>
				<a href="#">在线支付</a>
				<a href="#">货到付款</a>
				<a href="#">扫码支付</a>
				<a href="#">优惠券支付</a>
			</div>
			<div class="footer-info-item">
				<h3 style="background: url(../img/footer01.png) no-repeat 0 -67px"></h3>
				<a href="#">配送说明</a>
				<a href="#">运费说明</a>
				<a href="#">验货签收</a>
				<a href="#">货到付款</a>
			</div>
			<div class="footer-info-item">
				<h3 style="background: url(../img/footer01.png) no-repeat -29px -100px"></h3>
				<a href="#">退换货政策</a>
				<a href="#">退换货流程</a>
			</div>
			<div class="footer-info-item">
				<h3 style="background: url(../img/footer01.png) no-repeat -7px -134px"></h3>
				<a href="#">会员支付</a>
				<a href="#">会员积分</a>
				<a href="#">好评有礼</a>
			</div>
			<div class="footer-info-item">
				<h3 style="background: url(../img/footer01.png) no-repeat -9px -202px"></h3>
				<a href="#">品牌故事</a>
				<a href="#">媒体报道</a>
				<a href="#">诚聘英才</a>
				<a href="#">联系我们</a>
			</div>
		</div>
		<!-- footer-feature -->
		<div id="footer-feature">
			
		</div>
		<!-- footer-nav -->
		<div id="footer-nav">
			<a href="#" target="_blank">首页</a>&nbsp;&nbsp;|&nbsp;&nbsp;
			<a href="#" target="_blank">品牌故事</a>&nbsp;&nbsp;|&nbsp;&nbsp;
			<a href="#" target="_blank">诚聘英才</a>&nbsp;&nbsp;|&nbsp;&nbsp;
			<a href="#" target="_blank">媒体报道</a>&nbsp;&nbsp;|&nbsp;&nbsp;
			<a href="#" target="_blank">联系我们</a>&nbsp;&nbsp;|&nbsp;&nbsp;
			<a href="#" target="_blank">网站地图</a>&nbsp;&nbsp;|&nbsp;&nbsp;
			<a href="#" target="_blank">友情链接</a>
		</div>
		<!--copyright-info-->
		<div id="copyright-info">
			<p>
				<span><img src="../img/copyright.gif" alt=""><b>鲁ICP备14003322号-2 © 2006-2015 handu.com All Rights Reserved.</b></span>
				<span><img src="../img/beiantubiao.png" alt=""><a>鲁公网安备 37010202000113号</a></span>
				<span><b>山东韩都衣舍电商集团有限公司，禁止非法复制</b><img style="margin-top:10px" src="../img/pic.gif" alt=""></span>
			</p>
			<p>
				<img style="height:38px;margin-right:10px;" src="../img/zxmbutton02_sy.jpg" alt="">
				<a href="#"><img style="height:38px;margin-right:10px;" src="../img/zxmbutton05_sy.jpg" alt=""></a>
				<a href="#"><img style="height:38px;margin-right:10px;" src="../img/cnnic.png" alt=""></a>
				<img style="height:38px" src="../img/cctv.png" alt="">
			</p>
		</div>

	</div>

</body>
</html>